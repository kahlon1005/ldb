<div *ngIf="!selected">
    <div class="container page-header">Stuck Transaction List</div>    
        
    <div *ngIf="transactionExists" class="container"> 
            
        <table class="table table-striped table-bordered">
            <caption>List of Stuck Transactions</caption>
            <thead>
                <tr>
                    <td scope="col" class="column">Transaction Number</td>
                    <td scope="col" class="column">Transaction Type</td>
                    <td scope="col" class="column">Warehouse</td>
                    <td scope="col" class="column">Issue Description</td>
                    <td scope="col" class="column text-center">Action</td>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor = "let transaction of transactions">
                    <td>{{transaction.name}}</td>
                    <td>{{transaction.type}}</td>
                    <td>{{transaction.warehouse}}</td>
                    <td>{{transaction.message}}</td>                        
                    <td class="text-center">
                        <button (click) = "setTransaction(transaction.name, transaction.type, transaction.warehouse, transaction.message)" class="btn btn-primary">Start</button>                                            
                    </td>
                </tr>
            </tbody>
        </table>   
    </div>
    <div *ngIf="!transactionExists" class="container">    
        <div class="alert alert-primary" role="alert">
            <p>There are no transaction available to fix.</p>
        </div>    
    </div>
    <div class="container">
        <button (click) = "onRefresh()" class="btn btn-secondary">Refresh</button>    
    </div>
</div> 
<div *ngIf="selected" > 
    
    <div class="col-sm-8">

        <div class="card">
            <div class="card-header page-header">Apply Transaction Fix</div>

                <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()">
                    
                    <div class="card-body">
                        <fieldset disabled>
                            
                            <div class="form-group row">
                                <label for="transactionName" class="col-sm-4 col-form-label font-weight-bold text-right">Transaction Number:</label>
                              <div class="col-sm-8">
                                <input type="text" readonly class="form-control-plaintext" id="transactionName" formControlName="name"/>                                
                              </div>
                            </div>
                        
                            <div class="form-group row">
                              <label for="transactionType" class="col-sm-4 col-form-label font-weight-bold text-right">Transaction Type:</label>
                              <div class="col-sm-8">
                                <input type="text" readonly class="form-control-plaintext" id="transactionType" formControlName="type"/>                                
                              </div>
                            </div>
                            <div class="form-group row">
                                <label for="warehouse" class="col-sm-4 col-form-label font-weight-bold text-right">Warehouse:</label>
                              <div class="col-sm-8">
                                <input type="text" readonly class="form-control-plaintext" id="warehouse" formControlName="warehouse"/>                                
                              </div>
                            </div>
                            <div class="form-group row">
                              <label for="issueDescription" class="col-sm-4 col-form-label font-weight-bold text-right">Issue Description:</label>
                              <div class="col-sm-8">
                                <input type="text" readonly class="form-control-plaintext" id="issueDescription" formControlName="message"/>                                
                              </div>
                            </div>
                        </fieldset>
                            <div class="form-group row">
                                <label for="incidentNumber" class="col-sm-4 col-form-label font-weight-bold text-right">Incident Number:</label>
                                <div class="col-sm-8">
                                    <input type="text" formControlName="incidentNumber" class="form-control text-uppercase" [ngClass]="{ 'is-invalid': submitted && f.incidentNumber.errors }" placeholder="INC-NNNNNN" />
                                    <div *ngIf="submitted && f.incidentNumber.errors" class="invalid-feedback">
                                        <div *ngIf="f.incidentNumber.errors.required">Incident Number is required</div>
                                        <div *ngIf="f.incidentNumber.errors.minlength">Incident Number must be at least 10 characters long.</div>
                                    </div>
                                </div>                                
                            </div>
                            <div class="form-group row">
                                <label for="username" class="col-sm-4 col-form-label font-weight-bold text-right">Username:</label>
                                <div class="col-sm-8">
                                    <input type="text" formControlName="username" class="form-control" [ngClass]="{ 'is-invalid': submitted && f.username.errors }" />
                                    <div *ngIf="submitted && f.username.errors" class="invalid-feedback">
                                        <div *ngIf="f.username.errors.required">Username is required</div>
                                        <div *ngIf="f.username.errors.minlength">Username must be at least 4 characters long.</div>
                                    </div>
                                </div>                                
                            </div>
                    </div>
                    <div class="card-footer">
                        <div>
                            <button class="btn btn-primary mr-1 float-right">Submit</button>
                            <button class="btn btn-secondary" type="reset" (click)="onReset()">Cancel</button>
                        </div>
                    </div>
                </form>              
               
        </div>  
    </div>
    
  </div>

  <app-progress-spinner [color]="color" [mode]="mode" [value]="value" *ngIf="loading$ | async" class="center-aligned sq-global-backdrop"></app-progress-spinner>
